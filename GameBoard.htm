<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
    <link rel="stylesheet" href="css/main.css" />
    <link rel="icon" href="data:;base64,iVBORwOKGO=" />
    <script src="https://ajax.aspnetcdn.com/ajax/jquery/jquery-3.3.1.min.js" crossorigin="anonymous" integrity="sha384-tsQFqpEReu7ZLhBV2VZlAu7zcOV+rXbYlF2cqB8txI/8aZajjp4Bqd+V6D5IgvKT"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.12/handlebars.min.js"></script>
    <script type="text/javascript">
        var numRows = 12;
        var numCols = 15;
        $(document).ready(function () {
            $(".bordHolder").each(function () {
                var bord = $(this);
                for (var i = 1; i <= numRows; i++) {
                    var newRow = $("<div>", { "class": "bordRow" });
                    for (var j = 1; j <= numCols; j++) {
                        var cellId = i + "-" + j;
                        var newCell = $("<div>", { "class": "bordCell", "id": "cell_" + cellId, "onclick": "HandleCellClick(this)" });
                        newCell.append($("<span>", { "class": "cellId" }).append(cellId));
                        newCell.append($("<div>", { "class": "iconTopper" }))
                        newRow.append(newCell);
                    }
                    bord.append(newRow);
                }
            });

            ChangeCurrentOperation();
        });

        function GetSelectedOperationType() {
            return $("#operationSelector").val();
        }

        function HandleCellClick(cell) {
            // determine what operation is selected from dropdown
            //console.log(cell);
            var selectedOperation = GetSelectedOperationType();
            //console.log(selectedOperation);
            switch (selectedOperation) {
                case "markTerrain":
                    handleTerrainMarkOperation(cell);
                    break;
                case "markIcons":
                    handleIconmarkOperation(cell);
                    break;
                default:
                    console.log("Dont know what to do!!");
            }

            function handleTerrainMarkOperation(cell) {
                var terrainColor = $("input[name=markTerrain]:checked").val();
                if (!!terrainColor) {
                    $(cell).css("backgroundColor", terrainColor);
                }
                // else problem
            }

            function handleIconmarkOperation(cell) {
                var iconCode = $("input[name=markIcons]:checked").val();
                var iconCode_Frags = iconCode.split("_");
                if (iconCode_Frags.length === 3) {
                    // remove the old icon placement, if any, then stamp the new one in
                    $("div[data-iconTopperVal=" + iconCode + "]").each(function () { // should be just one, ya never know.
                        $(this).removeAttr("data-iconTopperVal", iconCode);
                        $(this).html("");
                        $(this).css("backgroundColor", "transparent");
                    })

                    var iconTopper = $(cell).find(".iconTopper");
                    iconTopper.attr("data-iconTopperVal", iconCode);
                    iconTopper.html(iconCode_Frags[1]);
                    iconTopper.css("backgroundColor", iconCode_Frags[2]);
                }
                // else problem
            }
        }


        function ChangeCurrentOperation() {
            $("#controlSections .controllSection")
                .hide()
                .find("input").prop("checked", false);

            var selectedOperation = GetSelectedOperationType();
            var operationDivToShow = $("#" + selectedOperation);
            if (operationDivToShow.length === 0) {
                console.log("ChangeCurrentOperation error: " + selectedOperation + " not matched");
                return;
            }
            operationDivToShow.show();
        }

    </script>
</head>
<body id="gameBoardBody">

    <div class="mainPageWrapper">
        <header>
            <h1>Heroes of Myradon</h1>
            <a href="Calc.htm">Calculator</a>
            <a href="Index.htm">Home</a>
        </header>

        <div id="controlsHolder">

            <div style="margin-bottom: 20px;">
                <h4>Select an Operation</h4>
                <select id="operationSelector" onchange="ChangeCurrentOperation();">
                    <option value="markTerrain" selected="selected">Mark Terrain Backgrounds</option>
                    <option value="markIcons">Mark Hero/Tower/Minion Locations</option>
                </select>
            </div>

            <div id="controlSections">
                <div class="controllSection" id="markTerrain" style="display: none;">
                    <h4>Select a color to mark terrain squares</h4>
                    <div>
                        <div><label><input type="radio" name="markTerrain" value="green" /> Green</label></div>
                        <div><label><input type="radio" name="markTerrain" value="grey" /> Gray</label></div>
                        <div><label><input type="radio" name="markTerrain" value="yellow" /> Yellow</label></div>
                        <div><label><input type="radio" name="markTerrain" value="brown" /> Brown</label></div>
                        <div><label><input type="radio" name="markTerrain" value="black" /> Black</label></div>
                        <div><label><input type="radio" name="markTerrain" value="transparent" /> Clear</label></div>
                    </div>
                </div>

                <div class="controllSection" id="markIcons" style="display: none;">

                    <h4>Select a Hero/Minion/Tower to move</h4>
                    <div>
                        <div><label><input type="radio" name="markIcons" value="h_GL_red" /> Golem</label></div>
                        <div><label><input type="radio" name="markIcons" value="h_WG_blue" /> Warforged Giant</label></div>
                        <div><label><input type="radio" name="markIcons" value="h_HM_red" /> Hitman</label></div>
                        <div><label><input type="radio" name="markIcons" value="h_BK_blue" /> Bandit King</label></div>
                    </div>
                    <div style="margin-top: 10px;">
                        <div><label><input type="radio" name="markIcons" value="t_TT_red" />Red Top Tower</label></div>
                        <div><label><input type="radio" name="markIcons" value="t_MT_red" />Red Mid Tower</label></div>
                        <div><label><input type="radio" name="markIcons" value="t_BT_red" />Red Bottom Tower</label></div>

                        <div><label><input type="radio" name="markIcons" value="m_TM1_red" />Red Top Minion #1</label></div>
                        <div><label><input type="radio" name="markIcons" value="m_TM2_red" />Red Top Minion #2</label></div>

                        <div><label><input type="radio" name="markIcons" value="m_MM1_red" />Red Middle Minion #1</label></div>
                        <div><label><input type="radio" name="markIcons" value="m_MM2_red" />Red Middle Minion #2</label></div>

                        <div><label><input type="radio" name="markIcons" value="m_BM1_red" />Red Bottom Minion #1</label></div>
                        <div><label><input type="radio" name="markIcons" value="m_BM2_red" />Red Bottom Minion #2</label></div>
                    </div>
                    <div style="margin-top: 10px;">
                        <div><label><input type="radio" name="markIcons" value="t_TT_blue" />Blue Top Tower</label></div>
                        <div><label><input type="radio" name="markIcons" value="t_MT_blue" />Blue Mid Tower</label></div>
                        <div><label><input type="radio" name="markIcons" value="t_BT_blue" />Blue Bottom Tower</label></div>

                        <div><label><input type="radio" name="markIcons" value="m_TM1_blue" />Blue Top Minion #1</label></div>
                        <div><label><input type="radio" name="markIcons" value="m_TM2_blue" />Blue Top Minion #2</label></div>

                        <div><label><input type="radio" name="markIcons" value="m_MM1_blue" />Blue Middle Minion #1</label></div>
                        <div><label><input type="radio" name="markIcons" value="m_MM2_blue" />Blue Middle Minion #2</label></div>

                        <div><label><input type="radio" name="markIcons" value="m_BM1_blue" />Blue Bottom Minion #1</label></div>
                        <div><label><input type="radio" name="markIcons" value="m_BM2_blue" />Blue Bottom Minion #2</label></div>
                    </div>
                </div>
            </div>

        </div>

        <div class="bordHolder"></div>

    </div>

</body>
</html>